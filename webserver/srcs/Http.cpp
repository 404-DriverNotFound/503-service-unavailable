#include "../includes/Http.hpp"

/*##############################################################################
	
	Http

##############################################################################*/

/*==============================================================================
	Constructor & Destructor
==============================================================================*/
Http::Http(int fd)
: _file(0),
  _stream(0xffff, 0, 0),
  _content_length(0)
{
}
//------------------------------------------------------------------------------
Http::~Http()
{
}

/*==============================================================================
	Method
==============================================================================*/

bool	Http::get_next_line()
{
	return _stream.get_line(_line);
}


/*==============================================================================
	Getter
==============================================================================*/

map<string, string>&	Http::get_headers()
{
	return	_headers;
}
//------------------------------------------------------------------------------
Stream&					Http::get_stream()
{
	return	_stream;
}
//------------------------------------------------------------------------------
string&					Http::get_string()
{
	return	_line;
}
//------------------------------------------------------------------------------
int						Http::get_file_fd()
{
	return	_file->get_fd();
}
//------------------------------------------------------------------------------
const string&			Http::get_header(const string& key)
{
	static		string	empty_str;
	map<string, string>::iterator	it = _headers.find(key);
	if (it == _headers.end())
	{
		return empty_str;
	}
	else
	{
		return it->second;
	}
}

/*==============================================================================
	Setter
==============================================================================*/

void					Http::set_file(File::flag f)
{
	_file = new File(f);
}
//------------------------------------------------------------------------------
void					Http::set_file(const string& path, File::flag f)
{
	_file = new File(path, f);
}
//------------------------------------------------------------------------------
void					Http::del_file()
{
	delete _file;
	_file = 0;
}
//------------------------------------------------------------------------------
void					Http::clear()
{
	_headers.clear();
	_protocol.clear();
	_line.clear();
	_stream.clear();
	del_file();
	_content_length = 0;
	_scheme.clear();
}